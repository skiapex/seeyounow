<!-- Use view helpers (e.g. link_to and image_tag) -->
<!-- and implement real data -->

<h3 class="page-header">
  <%= @patient.first_name %> <%= @patient.last_name %>
  <span class="pull-right">
    <%= link_to "Edit", edit_patient_path, class: 'btn btn-sm btn-success' %>
  </span>
</h3>
 <h3 span class="diagnosis"><%= @patient.diagnosis %>
 <span class="pull-right">
    <%= link_to "Complete ESAS assessment", new_esas_assessment_path, class: 'btn btn-sm btn-success' %>
  </span>
</h3>
<h3 span class="nul">
 <span class="pull-right">
    <%= link_to "Complete PFRS assessment", new_esas_assessment_path, class: 'btn btn-sm btn-success' %>
  </span>
</h3>

<div class="row">
  <div class="col-md-3">
    <p><strong>Gender:</strong> <%= @patient.gender.gender_type if @patient.gender %></p>
    <p><strong>Age:</strong> <%= @patient.age %></p>
    <p><strong>Address:</strong> <%= @patient.address %></p>
    <p><strong>Email:</strong> <%= current_user.try(:email) %></p>
    <p><strong>Phone number:</strong> <%= @patient.phone_number %></p>
    <p><strong>Other symptom:</strong> <%= OtherSymptom.find_by(id: @patient.other_symptom).symptom_type %></p>
    <p><strong>Caregiver name:</strong> <%= @patient.caregiver_name %></p>
  </div>
  <div class="col-md-3 summary">
    <h2>Goals of care:</h2>
    <p>
      <%= @patient.goals_of_care %>
    </p>
  </div>
  <div class="col-md-4 actors">
    <h2>ESAS Scores:</h2>
    <ul class="list-unstyled">
    <% @esas_assessments.each do |esas_assessment| %>
      <li>For <%= @patient.clinician.occupation.name %> <%= @patient.clinician.last_name %> at <%= link_to esas_assessment.time, esas_assessment_path(esas_assessment) %></li>
    <% end %>
    </ul>
  </div>
</div>

<div class="row">
  <div class="col-md-9 col-md-offset-3 reviews">
    <h2 class="page-header">Information</h2>
    <table class="table table-striped table-bordered">
      <tr>
        <td><strong>Shared with</strong></td>
        <td><%= @patient.shared_with %></td>
      </tr>      
      <tr>
        <td><strong>Patient deceased</strong></td>
        <td><%= @patient.patient_deceased %></td>
      </tr>
      <tr>
        <td><strong>Patient archived</strong></td>
        <td><%= @patient.patient_archived %></td>
      </tr>
    </table>
  </div>
</div>

<% scores = Array.new(9) %>
<% $i = 0 %>

<% @esas_assessments.each do |esas_assessment| %>


  <%= puts "#{name}. #{$i}" %>
  <% $i +=1 %>

  <li><%= name %><%= $i %></li>

<% end %>

<!-- <% @esas_assessments.each do |esas_assessment| %> -->
<!-- <li>ESAS <%= $i %> = [<%= @patient.last_name %>,<%= esas_assessment.time %>]
  <% $i +=1 %></li> -->




<head>
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script type="text/javascript">
    google.load('visualization', '1.1', {packages: ['line']});
    google.setOnLoadCallback(drawChart);

    function drawChart() {

      var data = new google.visualization.DataTable();
      data.addColumn('number', 'Day');
      data.addColumn('number', 'Pain');
      data.addColumn('number', 'Tiredness');
      data.addColumn('number', 'Drowsiness');
      data.addColumn('number', 'Nausea');
      data.addColumn('number', 'Lack of Appetite');
      data.addColumn('number', 'Shortness of Breath');
      data.addColumn('number', 'Depression');
      data.addColumn('number', 'Wellbeing');

      data.addRows([
        [1,  5,      3,      8,      7,      4,      6,      2,      3],
        [2,  4,      2,      7,      6,      5,      5,      3,      5],
        [3,  5,      5,      7,      5,      6,      6,      1,      4],
        [4,  6,      4,      8,      4,      9,      5,      3,      6],
        [5,  6,      4,      8,      4,      9,      5,      3,      6],
        [6,  6,      4,      8,      4,      9,      5,      3,      6],
        [7,  6,      4,      8,      4,      9,      5,      3,      6],
        [8,  6,      4,      8,      4,      9,      5,      3,      6],
        [9,  6,      4,      8,      4,      9,      5,      3,      6],
        [10, 6,      4,      8,      4,      9,      5,      3,      6],
        [11, 6,      4,      8,      4,      9,      5,      3,      6],
        [12, 6,      4,      8,      4,      9,      5,      3,      6],
        [13, 6,      4,      8,      4,      9,      5,      3,      6],
        [14, 6,      4,      8,      4,      9,      5,      3,      6]
      ]);

      var options = {
        chart: {
          title: 'Profile of Symptom Severity Over Time',
          subtitle: 'severity at the time of assessment of each symptom rated from 0 to 10 on a numerical scale, 0 meaning that the symptom is absent and 10 that it is of the worst possible severity'
        },
        width: 900,
        height: 500
      };

      var chart = new google.charts.Line(document.getElementById('linechart_material'));

      chart.draw(data, options);
    }
  </script>
</head>
<body>
  <div id="linechart_material"></div>
</body>